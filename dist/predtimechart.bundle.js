var e={870:(e,t)=>{function a(e,t){return{validate:e,compare:t}}t.u5=void 0,t.u5={date:a(r,n),time:a(l,d),"date-time":a((function(e){const t=e.split(c);return 2===t.length&&r(t[0])&&l(t[1],!0)}),m),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:function(e){return p.test(e)&&h.test(e)},"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:function(e){if(y.test(e))return!1;try{return new RegExp(e),!0}catch(e){return!1}},uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:function(e){return u.lastIndex=0,u.test(e)},int32:{type:"number",validate:function(e){return Number.isInteger(e)&&e<=_&&e>=f}},int64:{type:"number",validate:function(e){return Number.isInteger(e)}},float:{type:"number",validate:g},double:{type:"number",validate:g},password:!0,binary:!0},t.u5,a(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,n),a(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,d),a(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,m),Object.keys(t.u5);const s=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,i=[0,31,28,31,30,31,30,31,31,30,31,30,31];function r(e){const t=s.exec(e);if(!t)return!1;const a=+t[1],r=+t[2],n=+t[3];return r>=1&&r<=12&&n>=1&&n<=(2===r&&function(e){return e%4==0&&(e%100!=0||e%400==0)}(a)?29:i[r])}function n(e,t){if(e&&t)return e>t?1:e<t?-1:0}const o=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i;function l(e,t){const a=o.exec(e);if(!a)return!1;const s=+a[1],i=+a[2],r=+a[3],n=a[5];return(s<=23&&i<=59&&r<=59||23===s&&59===i&&60===r)&&(!t||""!==n)}function d(e,t){if(!e||!t)return;const a=o.exec(e),s=o.exec(t);return a&&s?(e=a[1]+a[2]+a[3]+(a[4]||""))>(t=s[1]+s[2]+s[3]+(s[4]||""))?1:e<t?-1:0:void 0}const c=/t|\s/i;function m(e,t){if(!e||!t)return;const[a,s]=e.split(c),[i,r]=t.split(c),o=n(a,i);return void 0!==o?o||d(s,r):void 0}const p=/\/|:/,h=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,u=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm,f=-(2**31),_=2**31-1;function g(){return!0}const y=/[^\\]\\Z/},510:(e,t,a)=>{const s=a(725);s.code='require("ajv/dist/runtime/equal").default',t.Z=s},499:(e,t)=>{function a(e){const t=e.length;let a,s=0,i=0;for(;i<t;)s++,a=e.charCodeAt(i++),a>=55296&&a<=56319&&i<t&&(a=e.charCodeAt(i),56320==(64512&a)&&i++);return s}t.Z=a,a.code='require("ajv/dist/runtime/ucs2length").default'},253:(e,t,a)=>{a.d(t,{Z:()=>o});var s=a(81),i=a.n(s),r=a(645),n=a.n(r)()(i());n.push([e.id,"/**\n * predtimechart: A JavaScript (ES6 ECMAScript) module for forecast visualization.\n */\n\n.forecastViz_dot {\n    height: 15px;\n    width: 15px;\n    border-radius: 50%;\n    border: 1px solid black;\n    display: inline-block;\n}\n\n.forecastViz_select_data {\n    font-size: 14px;\n}\n\n#forecastViz_select_model {\n    height: 48vh;\n    overflow-y: scroll;\n    font-size: 14px;\n}\n\n.forecastViz_disclaimer {\n    text-align: center;\n    margin-left: 3%;\n    margin-right: 3%;\n    font-size: 18px;\n}\n",""]);const o=n},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var a="",s=void 0!==t[5];return t[4]&&(a+="@supports (".concat(t[4],") {")),t[2]&&(a+="@media ".concat(t[2]," {")),s&&(a+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),a+=e(t),s&&(a+="}"),t[2]&&(a+="}"),t[4]&&(a+="}"),a})).join("")},t.i=function(e,a,s,i,r){"string"==typeof e&&(e=[[null,e,void 0]]);var n={};if(s)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(n[l]=!0)}for(var d=0;d<e.length;d++){var c=[].concat(e[d]);s&&n[c[0]]||(void 0!==r&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=r),a&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=a):c[2]=a),i&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=i):c[4]="".concat(i)),t.push(c))}},t}},81:e=>{e.exports=function(e){return e[1]}},725:e=>{e.exports=function e(t,a){if(t===a)return!0;if(t&&a&&"object"==typeof t&&"object"==typeof a){if(t.constructor!==a.constructor)return!1;var s,i,r;if(Array.isArray(t)){if((s=t.length)!=a.length)return!1;for(i=s;0!=i--;)if(!e(t[i],a[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===a.source&&t.flags===a.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===a.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===a.toString();if((s=(r=Object.keys(t)).length)!==Object.keys(a).length)return!1;for(i=s;0!=i--;)if(!Object.prototype.hasOwnProperty.call(a,r[i]))return!1;for(i=s;0!=i--;){var n=r[i];if(!e(t[n],a[n]))return!1}return!0}return t!=t&&a!=a}},379:e=>{var t=[];function a(e){for(var a=-1,s=0;s<t.length;s++)if(t[s].identifier===e){a=s;break}return a}function s(e,s){for(var r={},n=[],o=0;o<e.length;o++){var l=e[o],d=s.base?l[0]+s.base:l[0],c=r[d]||0,m="".concat(d," ").concat(c);r[d]=c+1;var p=a(m),h={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)t[p].references++,t[p].updater(h);else{var u=i(h,s);s.byIndex=o,t.splice(o,0,{identifier:m,updater:u,references:1})}n.push(m)}return n}function i(e,t){var a=t.domAPI(t);return a.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;a.update(e=t)}else a.remove()}}e.exports=function(e,i){var r=s(e=e||[],i=i||{});return function(e){e=e||[];for(var n=0;n<r.length;n++){var o=a(r[n]);t[o].references--}for(var l=s(e,i),d=0;d<r.length;d++){var c=a(r[d]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}r=l}}},569:e=>{var t={};e.exports=function(e,a){var s=function(e){if(void 0===t[e]){var a=document.querySelector(e);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}t[e]=a}return t[e]}(e);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(a)}},216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,a)=>{e.exports=function(e){var t=a.nc;t&&e.setAttribute("nonce",t)}},795:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(a){!function(e,t,a){var s="";a.supports&&(s+="@supports (".concat(a.supports,") {")),a.media&&(s+="@media ".concat(a.media," {"));var i=void 0!==a.layer;i&&(s+="@layer".concat(a.layer.length>0?" ".concat(a.layer):""," {")),s+=a.css,i&&(s+="}"),a.media&&(s+="}"),a.supports&&(s+="}");var r=a.sourceMap;r&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleTagTransform(s,e,t.options)}(t,e,a)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},840:(e,t,a)=>{e.exports=c,e.exports.default=c;const s={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://github.com/reichlab/predtimechart/blob/main/src/schema.json",title:"predtimechart options",description:"predtimechart options object schema",type:"object",additionalProperties:!1,properties:{available_as_ofs:{description:"`object` that maps `target_variables` `value` to an `array` of dates in 'YYYY-MM-DD' format that have truth and/or forecasts available",type:"object",minProperties:1,additionalProperties:{type:"array",minItems:1,items:{type:"string",format:"date"}}},current_date:{description:"`available_as_ofs` `value` key to use for the initial plot",type:"string",format:"date"},disclaimer:{description:"`string` providing any important information users should know",type:"string",minLength:1},initial_as_of:{description:"`string` specifying the initial date from 'available_as_ofs' (in 'YYYY-MM-DD' format) to use for the initially-selected _as_of_ date",type:"string",format:"date"},initial_checked_models:{description:"`models` value(s) to use for the initial plot",type:"array",uniqueItems:!0},initial_interval:{description:"`intervals` value to use for the initial plot",type:"string"},initial_target_var:{description:"`target_variables` `value` key to use for the initial plot",type:"string"},initial_task_ids:{description:"an `object` to use for the initial plot. format is identical to `_fetchData()`'s `taskIDs` arg",type:"object",minProperties:1},initial_xaxis_range:{description:"`array` of two dates in 'YYYY-MM-DD' format that specify the initial xaxis range to use. To not initialize the range, pass `null` for its value",type:["array","null"],minItems:2,maxItems:2,uniqueItems:!0,items:{type:"string",format:"date"}},initial_yaxis_range:{description:"`array` of two values (format depends on outcome variable) that specify the initial yaxis range to use. To not initialize the range, pass `null` for its value",type:["array","null"],minItems:2,maxItems:2,uniqueItems:!0,items:{oneOf:[{type:"string"},{type:"number"}]}},intervals:{description:"`array` of one or more strings of the format '<integer>%' between '0%' and '100%' inclusive, representing percentages. Currently only '50%' and '95%' are used (purpose: TBD)",type:"array",minItems:1,uniqueItems:!0,items:{type:"string",pattern:"^[1-9]?[0-9]%$"}},models:{description:"`array` of model names (`string`s) that provide data",type:"array",minItems:1,uniqueItems:!0},target_variables:{description:"`array` of `object`s defining the target variables in the data. Each object contains three keys: `value`, `text`, `plot_text`",type:"array",minItems:1,items:{type:"object",additionalProperties:!1,properties:{value:{description:"used as the main value that's passed around for the target",type:"string",minLength:1},text:{description:"human-readable text",type:"string",minLength:1},plot_text:{description:"plot text",type:"string",minLength:1}},required:["value","text","plot_text"]}},task_ids:{description:"`object` defining the _tasks_ in the data as described in `_fetchData`'s `taskIDs` arg",type:"object",minProperties:1,patternProperties:{"^[A-Za-z]+[A-Za-z0-9_-]*$":{type:"array",items:{type:"object",properties:{value:{description:"used as the main value that's passed around for the task_id",type:"string",minLength:1},text:{description:"human-readable text",type:"string",minLength:1}}}}},additionalProperties:!1}},required:["available_as_ofs","current_date","disclaimer","initial_as_of","initial_checked_models","initial_interval","initial_target_var","initial_task_ids","intervals","models","target_variables","task_ids"]},i=Object.prototype.hasOwnProperty,r=a(499).Z,n=a(510).Z,o=a(870).u5.date,l=new RegExp("^[1-9]?[0-9]%$","u"),d=new RegExp("^[A-Za-z]+[A-Za-z0-9_-]*$","u");function c(e,{instancePath:t="",parentData:a,parentDataProperty:m,rootData:p=e}={}){let h=null,u=0;if(e&&"object"==typeof e&&!Array.isArray(e)){if(void 0===e.available_as_ofs){const e={instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:"available_as_ofs"},message:"must have required property 'available_as_ofs'"};null===h?h=[e]:h.push(e),u++}if(void 0===e.current_date){const e={instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:"current_date"},message:"must have required property 'current_date'"};null===h?h=[e]:h.push(e),u++}if(void 0===e.disclaimer){const e={instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:"disclaimer"},message:"must have required property 'disclaimer'"};null===h?h=[e]:h.push(e),u++}if(void 0===e.initial_as_of){const e={instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:"initial_as_of"},message:"must have required property 'initial_as_of'"};null===h?h=[e]:h.push(e),u++}if(void 0===e.initial_checked_models){const e={instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:"initial_checked_models"},message:"must have required property 'initial_checked_models'"};null===h?h=[e]:h.push(e),u++}if(void 0===e.initial_interval){const e={instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:"initial_interval"},message:"must have required property 'initial_interval'"};null===h?h=[e]:h.push(e),u++}if(void 0===e.initial_target_var){const e={instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:"initial_target_var"},message:"must have required property 'initial_target_var'"};null===h?h=[e]:h.push(e),u++}if(void 0===e.initial_task_ids){const e={instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:"initial_task_ids"},message:"must have required property 'initial_task_ids'"};null===h?h=[e]:h.push(e),u++}if(void 0===e.intervals){const e={instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:"intervals"},message:"must have required property 'intervals'"};null===h?h=[e]:h.push(e),u++}if(void 0===e.models){const e={instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:"models"},message:"must have required property 'models'"};null===h?h=[e]:h.push(e),u++}if(void 0===e.target_variables){const e={instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:"target_variables"},message:"must have required property 'target_variables'"};null===h?h=[e]:h.push(e),u++}if(void 0===e.task_ids){const e={instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:"task_ids"},message:"must have required property 'task_ids'"};null===h?h=[e]:h.push(e),u++}for(const a in e)if(!i.call(s.properties,a)){const e={instancePath:t,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:a},message:"must NOT have additional properties"};null===h?h=[e]:h.push(e),u++}if(void 0!==e.available_as_ofs){let a=e.available_as_ofs;if(a&&"object"==typeof a&&!Array.isArray(a)){if(Object.keys(a).length<1){const e={instancePath:t+"/available_as_ofs",schemaPath:"#/properties/available_as_ofs/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"};null===h?h=[e]:h.push(e),u++}for(const e in a){let s=a[e];if(Array.isArray(s)){if(s.length<1){const a={instancePath:t+"/available_as_ofs/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/available_as_ofs/additionalProperties/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"};null===h?h=[a]:h.push(a),u++}const a=s.length;for(let i=0;i<a;i++){let a=s[i];if("string"==typeof a){if(!o.validate(a)){const a={instancePath:t+"/available_as_ofs/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+i,schemaPath:"#/properties/available_as_ofs/additionalProperties/items/format",keyword:"format",params:{format:"date"},message:'must match format "date"'};null===h?h=[a]:h.push(a),u++}}else{const a={instancePath:t+"/available_as_ofs/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+i,schemaPath:"#/properties/available_as_ofs/additionalProperties/items/type",keyword:"type",params:{type:"string"},message:"must be string"};null===h?h=[a]:h.push(a),u++}}}else{const a={instancePath:t+"/available_as_ofs/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/available_as_ofs/additionalProperties/type",keyword:"type",params:{type:"array"},message:"must be array"};null===h?h=[a]:h.push(a),u++}}}else{const e={instancePath:t+"/available_as_ofs",schemaPath:"#/properties/available_as_ofs/type",keyword:"type",params:{type:"object"},message:"must be object"};null===h?h=[e]:h.push(e),u++}}if(void 0!==e.current_date){let a=e.current_date;if("string"==typeof a){if(!o.validate(a)){const e={instancePath:t+"/current_date",schemaPath:"#/properties/current_date/format",keyword:"format",params:{format:"date"},message:'must match format "date"'};null===h?h=[e]:h.push(e),u++}}else{const e={instancePath:t+"/current_date",schemaPath:"#/properties/current_date/type",keyword:"type",params:{type:"string"},message:"must be string"};null===h?h=[e]:h.push(e),u++}}if(void 0!==e.disclaimer){let a=e.disclaimer;if("string"==typeof a){if(r(a)<1){const e={instancePath:t+"/disclaimer",schemaPath:"#/properties/disclaimer/minLength",keyword:"minLength",params:{limit:1},message:"must NOT have fewer than 1 characters"};null===h?h=[e]:h.push(e),u++}}else{const e={instancePath:t+"/disclaimer",schemaPath:"#/properties/disclaimer/type",keyword:"type",params:{type:"string"},message:"must be string"};null===h?h=[e]:h.push(e),u++}}if(void 0!==e.initial_as_of){let a=e.initial_as_of;if("string"==typeof a){if(!o.validate(a)){const e={instancePath:t+"/initial_as_of",schemaPath:"#/properties/initial_as_of/format",keyword:"format",params:{format:"date"},message:'must match format "date"'};null===h?h=[e]:h.push(e),u++}}else{const e={instancePath:t+"/initial_as_of",schemaPath:"#/properties/initial_as_of/type",keyword:"type",params:{type:"string"},message:"must be string"};null===h?h=[e]:h.push(e),u++}}if(void 0!==e.initial_checked_models){let a=e.initial_checked_models;if(Array.isArray(a)){let e,s=a.length;if(s>1)e:for(;s--;)for(e=s;e--;)if(n(a[s],a[e])){const a={instancePath:t+"/initial_checked_models",schemaPath:"#/properties/initial_checked_models/uniqueItems",keyword:"uniqueItems",params:{i:s,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+s+" are identical)"};null===h?h=[a]:h.push(a),u++;break e}}else{const e={instancePath:t+"/initial_checked_models",schemaPath:"#/properties/initial_checked_models/type",keyword:"type",params:{type:"array"},message:"must be array"};null===h?h=[e]:h.push(e),u++}}if(void 0!==e.initial_interval&&"string"!=typeof e.initial_interval){const e={instancePath:t+"/initial_interval",schemaPath:"#/properties/initial_interval/type",keyword:"type",params:{type:"string"},message:"must be string"};null===h?h=[e]:h.push(e),u++}if(void 0!==e.initial_target_var&&"string"!=typeof e.initial_target_var){const e={instancePath:t+"/initial_target_var",schemaPath:"#/properties/initial_target_var/type",keyword:"type",params:{type:"string"},message:"must be string"};null===h?h=[e]:h.push(e),u++}if(void 0!==e.initial_task_ids){let a=e.initial_task_ids;if(a&&"object"==typeof a&&!Array.isArray(a)){if(Object.keys(a).length<1){const e={instancePath:t+"/initial_task_ids",schemaPath:"#/properties/initial_task_ids/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"};null===h?h=[e]:h.push(e),u++}}else{const e={instancePath:t+"/initial_task_ids",schemaPath:"#/properties/initial_task_ids/type",keyword:"type",params:{type:"object"},message:"must be object"};null===h?h=[e]:h.push(e),u++}}if(void 0!==e.initial_xaxis_range){let a=e.initial_xaxis_range;if(!Array.isArray(a)&&null!==a){const e={instancePath:t+"/initial_xaxis_range",schemaPath:"#/properties/initial_xaxis_range/type",keyword:"type",params:{type:s.properties.initial_xaxis_range.type},message:"must be array,null"};null===h?h=[e]:h.push(e),u++}if(Array.isArray(a)){if(a.length>2){const e={instancePath:t+"/initial_xaxis_range",schemaPath:"#/properties/initial_xaxis_range/maxItems",keyword:"maxItems",params:{limit:2},message:"must NOT have more than 2 items"};null===h?h=[e]:h.push(e),u++}if(a.length<2){const e={instancePath:t+"/initial_xaxis_range",schemaPath:"#/properties/initial_xaxis_range/minItems",keyword:"minItems",params:{limit:2},message:"must NOT have fewer than 2 items"};null===h?h=[e]:h.push(e),u++}const e=a.length;for(let s=0;s<e;s++){let e=a[s];if("string"==typeof e){if(!o.validate(e)){const e={instancePath:t+"/initial_xaxis_range/"+s,schemaPath:"#/properties/initial_xaxis_range/items/format",keyword:"format",params:{format:"date"},message:'must match format "date"'};null===h?h=[e]:h.push(e),u++}}else{const e={instancePath:t+"/initial_xaxis_range/"+s,schemaPath:"#/properties/initial_xaxis_range/items/type",keyword:"type",params:{type:"string"},message:"must be string"};null===h?h=[e]:h.push(e),u++}}let s,i=a.length;if(i>1){const e={};for(;i--;){let r=a[i];if("string"==typeof r){if("number"==typeof e[r]){s=e[r];const a={instancePath:t+"/initial_xaxis_range",schemaPath:"#/properties/initial_xaxis_range/uniqueItems",keyword:"uniqueItems",params:{i,j:s},message:"must NOT have duplicate items (items ## "+s+" and "+i+" are identical)"};null===h?h=[a]:h.push(a),u++;break}e[r]=i}}}}}if(void 0!==e.initial_yaxis_range){let a=e.initial_yaxis_range;if(!Array.isArray(a)&&null!==a){const e={instancePath:t+"/initial_yaxis_range",schemaPath:"#/properties/initial_yaxis_range/type",keyword:"type",params:{type:s.properties.initial_yaxis_range.type},message:"must be array,null"};null===h?h=[e]:h.push(e),u++}if(Array.isArray(a)){if(a.length>2){const e={instancePath:t+"/initial_yaxis_range",schemaPath:"#/properties/initial_yaxis_range/maxItems",keyword:"maxItems",params:{limit:2},message:"must NOT have more than 2 items"};null===h?h=[e]:h.push(e),u++}if(a.length<2){const e={instancePath:t+"/initial_yaxis_range",schemaPath:"#/properties/initial_yaxis_range/minItems",keyword:"minItems",params:{limit:2},message:"must NOT have fewer than 2 items"};null===h?h=[e]:h.push(e),u++}const e=a.length;for(let s=0;s<e;s++){let e=a[s];const i=u;let r=!1,n=null;const o=u;if("string"!=typeof e){const e={instancePath:t+"/initial_yaxis_range/"+s,schemaPath:"#/properties/initial_yaxis_range/items/oneOf/0/type",keyword:"type",params:{type:"string"},message:"must be string"};null===h?h=[e]:h.push(e),u++}o===u&&(r=!0,n=0);const l=u;if("number"!=typeof e||!isFinite(e)){const e={instancePath:t+"/initial_yaxis_range/"+s,schemaPath:"#/properties/initial_yaxis_range/items/oneOf/1/type",keyword:"type",params:{type:"number"},message:"must be number"};null===h?h=[e]:h.push(e),u++}var f;if((f=l===u)&&r?(r=!1,n=[n,1]):f&&(r=!0,n=1),r)u=i,null!==h&&(i?h.length=i:h=null);else{const e={instancePath:t+"/initial_yaxis_range/"+s,schemaPath:"#/properties/initial_yaxis_range/items/oneOf",keyword:"oneOf",params:{passingSchemas:n},message:"must match exactly one schema in oneOf"};null===h?h=[e]:h.push(e),u++}}let s,i=a.length;if(i>1)e:for(;i--;)for(s=i;s--;)if(n(a[i],a[s])){const e={instancePath:t+"/initial_yaxis_range",schemaPath:"#/properties/initial_yaxis_range/uniqueItems",keyword:"uniqueItems",params:{i,j:s},message:"must NOT have duplicate items (items ## "+s+" and "+i+" are identical)"};null===h?h=[e]:h.push(e),u++;break e}}}if(void 0!==e.intervals){let a=e.intervals;if(Array.isArray(a)){if(a.length<1){const e={instancePath:t+"/intervals",schemaPath:"#/properties/intervals/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"};null===h?h=[e]:h.push(e),u++}const e=a.length;for(let s=0;s<e;s++){let e=a[s];if("string"==typeof e){if(!l.test(e)){const e={instancePath:t+"/intervals/"+s,schemaPath:"#/properties/intervals/items/pattern",keyword:"pattern",params:{pattern:"^[1-9]?[0-9]%$"},message:'must match pattern "^[1-9]?[0-9]%$"'};null===h?h=[e]:h.push(e),u++}}else{const e={instancePath:t+"/intervals/"+s,schemaPath:"#/properties/intervals/items/type",keyword:"type",params:{type:"string"},message:"must be string"};null===h?h=[e]:h.push(e),u++}}let s,i=a.length;if(i>1){const e={};for(;i--;){let r=a[i];if("string"==typeof r){if("number"==typeof e[r]){s=e[r];const a={instancePath:t+"/intervals",schemaPath:"#/properties/intervals/uniqueItems",keyword:"uniqueItems",params:{i,j:s},message:"must NOT have duplicate items (items ## "+s+" and "+i+" are identical)"};null===h?h=[a]:h.push(a),u++;break}e[r]=i}}}}else{const e={instancePath:t+"/intervals",schemaPath:"#/properties/intervals/type",keyword:"type",params:{type:"array"},message:"must be array"};null===h?h=[e]:h.push(e),u++}}if(void 0!==e.models){let a=e.models;if(Array.isArray(a)){if(a.length<1){const e={instancePath:t+"/models",schemaPath:"#/properties/models/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"};null===h?h=[e]:h.push(e),u++}let e,s=a.length;if(s>1)e:for(;s--;)for(e=s;e--;)if(n(a[s],a[e])){const a={instancePath:t+"/models",schemaPath:"#/properties/models/uniqueItems",keyword:"uniqueItems",params:{i:s,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+s+" are identical)"};null===h?h=[a]:h.push(a),u++;break e}}else{const e={instancePath:t+"/models",schemaPath:"#/properties/models/type",keyword:"type",params:{type:"array"},message:"must be array"};null===h?h=[e]:h.push(e),u++}}if(void 0!==e.target_variables){let a=e.target_variables;if(Array.isArray(a)){if(a.length<1){const e={instancePath:t+"/target_variables",schemaPath:"#/properties/target_variables/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"};null===h?h=[e]:h.push(e),u++}const e=a.length;for(let s=0;s<e;s++){let e=a[s];if(e&&"object"==typeof e&&!Array.isArray(e)){if(void 0===e.value){const e={instancePath:t+"/target_variables/"+s,schemaPath:"#/properties/target_variables/items/required",keyword:"required",params:{missingProperty:"value"},message:"must have required property 'value'"};null===h?h=[e]:h.push(e),u++}if(void 0===e.text){const e={instancePath:t+"/target_variables/"+s,schemaPath:"#/properties/target_variables/items/required",keyword:"required",params:{missingProperty:"text"},message:"must have required property 'text'"};null===h?h=[e]:h.push(e),u++}if(void 0===e.plot_text){const e={instancePath:t+"/target_variables/"+s,schemaPath:"#/properties/target_variables/items/required",keyword:"required",params:{missingProperty:"plot_text"},message:"must have required property 'plot_text'"};null===h?h=[e]:h.push(e),u++}for(const a in e)if("value"!==a&&"text"!==a&&"plot_text"!==a){const e={instancePath:t+"/target_variables/"+s,schemaPath:"#/properties/target_variables/items/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:a},message:"must NOT have additional properties"};null===h?h=[e]:h.push(e),u++}if(void 0!==e.value){let a=e.value;if("string"==typeof a){if(r(a)<1){const e={instancePath:t+"/target_variables/"+s+"/value",schemaPath:"#/properties/target_variables/items/properties/value/minLength",keyword:"minLength",params:{limit:1},message:"must NOT have fewer than 1 characters"};null===h?h=[e]:h.push(e),u++}}else{const e={instancePath:t+"/target_variables/"+s+"/value",schemaPath:"#/properties/target_variables/items/properties/value/type",keyword:"type",params:{type:"string"},message:"must be string"};null===h?h=[e]:h.push(e),u++}}if(void 0!==e.text){let a=e.text;if("string"==typeof a){if(r(a)<1){const e={instancePath:t+"/target_variables/"+s+"/text",schemaPath:"#/properties/target_variables/items/properties/text/minLength",keyword:"minLength",params:{limit:1},message:"must NOT have fewer than 1 characters"};null===h?h=[e]:h.push(e),u++}}else{const e={instancePath:t+"/target_variables/"+s+"/text",schemaPath:"#/properties/target_variables/items/properties/text/type",keyword:"type",params:{type:"string"},message:"must be string"};null===h?h=[e]:h.push(e),u++}}if(void 0!==e.plot_text){let a=e.plot_text;if("string"==typeof a){if(r(a)<1){const e={instancePath:t+"/target_variables/"+s+"/plot_text",schemaPath:"#/properties/target_variables/items/properties/plot_text/minLength",keyword:"minLength",params:{limit:1},message:"must NOT have fewer than 1 characters"};null===h?h=[e]:h.push(e),u++}}else{const e={instancePath:t+"/target_variables/"+s+"/plot_text",schemaPath:"#/properties/target_variables/items/properties/plot_text/type",keyword:"type",params:{type:"string"},message:"must be string"};null===h?h=[e]:h.push(e),u++}}}else{const e={instancePath:t+"/target_variables/"+s,schemaPath:"#/properties/target_variables/items/type",keyword:"type",params:{type:"object"},message:"must be object"};null===h?h=[e]:h.push(e),u++}}}else{const e={instancePath:t+"/target_variables",schemaPath:"#/properties/target_variables/type",keyword:"type",params:{type:"array"},message:"must be array"};null===h?h=[e]:h.push(e),u++}}if(void 0!==e.task_ids){let a=e.task_ids;if(a&&"object"==typeof a&&!Array.isArray(a)){if(Object.keys(a).length<1){const e={instancePath:t+"/task_ids",schemaPath:"#/properties/task_ids/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"};null===h?h=[e]:h.push(e),u++}for(const e in a)if(!d.test(e)){const a={instancePath:t+"/task_ids",schemaPath:"#/properties/task_ids/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:e},message:"must NOT have additional properties"};null===h?h=[a]:h.push(a),u++}for(const e in a)if(d.test(e)){let s=a[e];if(Array.isArray(s)){const a=s.length;for(let i=0;i<a;i++){let a=s[i];if(a&&"object"==typeof a&&!Array.isArray(a)){if(void 0!==a.value){let s=a.value;if("string"==typeof s){if(r(s)<1){const a={instancePath:t+"/task_ids/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+i+"/value",schemaPath:"#/properties/task_ids/patternProperties/%5E%5BA-Za-z%5D%2B%5BA-Za-z0-9_-%5D*%24/items/properties/value/minLength",keyword:"minLength",params:{limit:1},message:"must NOT have fewer than 1 characters"};null===h?h=[a]:h.push(a),u++}}else{const a={instancePath:t+"/task_ids/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+i+"/value",schemaPath:"#/properties/task_ids/patternProperties/%5E%5BA-Za-z%5D%2B%5BA-Za-z0-9_-%5D*%24/items/properties/value/type",keyword:"type",params:{type:"string"},message:"must be string"};null===h?h=[a]:h.push(a),u++}}if(void 0!==a.text){let s=a.text;if("string"==typeof s){if(r(s)<1){const a={instancePath:t+"/task_ids/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+i+"/text",schemaPath:"#/properties/task_ids/patternProperties/%5E%5BA-Za-z%5D%2B%5BA-Za-z0-9_-%5D*%24/items/properties/text/minLength",keyword:"minLength",params:{limit:1},message:"must NOT have fewer than 1 characters"};null===h?h=[a]:h.push(a),u++}}else{const a={instancePath:t+"/task_ids/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+i+"/text",schemaPath:"#/properties/task_ids/patternProperties/%5E%5BA-Za-z%5D%2B%5BA-Za-z0-9_-%5D*%24/items/properties/text/type",keyword:"type",params:{type:"string"},message:"must be string"};null===h?h=[a]:h.push(a),u++}}}else{const a={instancePath:t+"/task_ids/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+i,schemaPath:"#/properties/task_ids/patternProperties/%5E%5BA-Za-z%5D%2B%5BA-Za-z0-9_-%5D*%24/items/type",keyword:"type",params:{type:"object"},message:"must be object"};null===h?h=[a]:h.push(a),u++}}}else{const a={instancePath:t+"/task_ids/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/task_ids/patternProperties/%5E%5BA-Za-z%5D%2B%5BA-Za-z0-9_-%5D*%24/type",keyword:"type",params:{type:"array"},message:"must be array"};null===h?h=[a]:h.push(a),u++}}}else{const e={instancePath:t+"/task_ids",schemaPath:"#/properties/task_ids/type",keyword:"type",params:{type:"object"},message:"must be object"};null===h?h=[e]:h.push(e),u++}}}else{const e={instancePath:t,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"};null===h?h=[e]:h.push(e),u++}return c.errors=h,0===u}}},t={};function a(s){var i=t[s];if(void 0!==i)return i.exports;var r=t[s]={id:s,exports:{}};return e[s](r,r.exports,a),r.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.nc=void 0;var s,i,r,n,o,l,d,c,m,p,h,u,f,_,g={};s=a(379),i=a.n(s),r=a(795),n=a.n(r),o=a(569),l=a.n(o),d=a(565),c=a.n(d),m=a(216),p=a.n(m),h=a(589),u=a.n(h),f=a(253),(_={}).styleTagTransform=u(),_.setAttributes=c(),_.insert=l().bind(null,"head"),_.domAPI=n(),_.insertStyleElement=p(),i()(f.Z,_),f.Z&&f.Z.locals&&f.Z.locals,(()=>{function e(e){return new Date(parseInt(e.slice(0,4)),parseInt(e.slice(5,7))-1,parseInt(e.slice(8,10)))}function t(e){var t=0;return e.forEach((e=>{if("number"!=typeof e)throw new Error(`array item was not a number: ${e}`);t+=e})),t/e.length}a.d(g,{Z:()=>m});const s=function(e,a){if(0===e.length)throw new Error("_calcUemForecasts(): must have one or more componentModels");const s=[];if(e.forEach((e=>{Object.hasOwn(a,e)||s.push(e)})),0!==s.length)throw new Error(`_calcUemForecasts(): some models had no forecast data: ${s}`);const i=new Set(e.map((e=>JSON.stringify(Object.keys(a[e])))));if(1!==i.size)throw new Error(`not all forecasts had the same quantiles: ${JSON.stringify([...i])}`);const r=[];e.forEach((e=>{r.push(new Set(a[e].target_end_date))}));const n=r.reduce(((e,t)=>new Set([...e].filter((e=>t.has(e))))));if(0===n.size)throw new Error("_calcUemForecasts(): forecasts had no common target_end_dates");const o={};e.forEach((e=>{o[e]=[...n].map((t=>a[e].target_end_date.indexOf(t)))}));const l=a[e[0]],d={target_end_date:[...n]};return Object.keys(l).forEach((s=>{if(s.startsWith("q0.")){const i=[];e.forEach((e=>{const t=a[e][s],r=o[e].map((e=>t[e]));i.push(r)})),d[s]=function(e){const a=new Set(e.map((e=>e.length)));if(1!==a.size)throw new Error(`quantileArrays not all the same length: ${e}`);const s=[];for(let i=0;i<a.values().next().value;i++){const a=[];e.forEach((e=>{a.push(e[i])}));const r=t(a);s.push(r)}return s}(i)}})),d};var i=a(840);const r=function(e){if(null===e||"object"!=typeof e)throw"options object is required but missing";if(!i(e))throw console.error(`_validateOptions(): invalid schema. ${i.errors.length} error(s). options:, errors:`,JSON.stringify(e,null,"    "),i.errors),`invalid options structure: ${i.errors.map((e=>JSON.stringify(e))).join(", ")}`;const t=e.available_as_ofs,a=e.target_variables;Object.keys(t).forEach((e=>{let t=!1;if(a.forEach((a=>{a.value===e&&(t=!0)})),!t)throw`available_as_ofs key not in target_variables value. key=${e}`}));const s=e.models;e.initial_checked_models.forEach((e=>{if(!s.includes(e))throw`initial_checked_models model not in models: ${e}`}));const r=e.initial_interval;if(!e.intervals.includes(r))throw`initial_interval not in intervals: ${r}`;const n=a.map((e=>e.value)),o=e.initial_target_var;if(!n.includes(o))throw`initial_target_var not in target_variables: ${o}`;const l=e.initial_as_of;if(!t[o].includes(l))throw`initial_as_of not in available_as_ofs: ${l}`;const d=e.task_ids,c=e.initial_task_ids;if(m=new Set(Object.keys(d)),p=new Set(Object.keys(c)),m.size!==p.size||![...m].every((e=>p.has(e))))throw`initial_task_ids key !== task_ids: ${JSON.stringify(c)}`;var m,p;Object.keys(c).forEach((e=>{const t=c[e],a=d[e].map((e=>e.value));if(!a.includes(t))throw`initial_task_ids value not in task_ids. initialTaskIdValue=${t}, taskIdValues=${a}`}))},n={name:"User-Ensemble",models:[],lastError:null};function o(e,t,a,s){return`<div class="form-group form-check"\n                 style="margin-bottom: 0${a?"":"; color: lightgrey"}">\n                <label>\n                    <input type="checkbox" id="${e}" class="model-check" ${s?"checked":""}>\n                    &nbsp;${e}\n                    &nbsp;<span class="forecastViz_dot" style="background-color: ${t}; "></span>\n                </label>\n            </div>`}function l(){const e=$("#forecastViz_Current_Truth").prop("checked"),t=$("#forecastViz_Truth_as_of").prop("checked"),a=[];e&&a.push("Current Target"),t&&a.push("Target as of"),this.state.selected_truth=a,this.fetchDataUpdatePlot(!1,!1)}function d(e,t){console.log(`flashMessage(): ${t}`),$(`\n        <div class="modal fade" id="showDialogModal" tabindex="-1" role="dialog" aria-labelledby="showDialogModalLabel" aria-hidden="true">\n          <div class="modal-dialog" role="document">\n            <div class="modal-content">\n              <div class="modal-header">\n                <h5 class="modal-title" id="showDialogModalLabel">${e}</h5>\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                  <span aria-hidden="true">&times;</span>\n                </button>\n              </div>\n              <div class="modal-body">${t}</div>\n              <div class="modal-footer">\n                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>\n              </div>\n            </div>\n          </div>\n        </div>`).modal("show")}const c={isIndicateRedraw:!1,_fetchData:null,_calcUemForecasts:null,isUemEnabled:!0,state:{target_variables:[],task_ids:[],intervals:[],available_as_ofs:[],current_date:"",models:[],disclaimer:"",selected_target_var:"",selected_interval:"",selected_as_of_date:"",selected_truth:["Current Target","Target as of"],selected_models:[],last_selected_models:[],colors:[],initial_xaxis_range:null,initial_yaxis_range:null,current_truth:[],as_of_truth:[],forecasts:{}},initialize(e,t,a,s,i){this._fetchData=t,this.isIndicateRedraw=a,this._calcUemForecasts=i,console.debug("initialize(): entered");const o=document.getElementById(e);if(null===o)throw`componentDiv DOM node not found: '${e}'`;try{r(s),console.debug("initialize(): passed options are valid")}catch(e){return console.error(`invalid option(s): ${e}`),d("Init failed due to invalid option(s)",e),e}let l=!1;const c=this.getOptionsFromURL(s.task_ids);if(0!==Object.keys(c).length){const e={...s,...c};try{r(e),console.debug("initialize(): merged options are valid"),s=e}catch(e){console.error(`invalid URL option(s): ${e}`),d("Ignoring invalid URL parameter(s)",e),l=!0}}if(this.state.target_variables=s.target_variables,this.state.task_ids=s.task_ids,this.state.intervals=s.intervals,this.state.available_as_ofs=s.available_as_ofs,this.state.current_date=s.current_date,this.state.models=s.models,this.state.disclaimer=s.disclaimer,this.state.colors=Array(parseInt(this.state.models.length/10,10)+1).fill(["#0d0887","#46039f","#7201a8","#9c179e","#bd3786","#d8576b","#ed7953","#fb9f3a","#fdca26","#f0f921"]).flat(),this.state.initial_xaxis_range=s.hasOwnProperty("initial_xaxis_range")?s.initial_xaxis_range:null,this.state.initial_yaxis_range=s.hasOwnProperty("initial_yaxis_range")?s.initial_yaxis_range:null,this.state.selected_target_var=s.initial_target_var,this.state.selected_interval=s.initial_interval,this.state.selected_as_of_date=s.initial_as_of,this.state.selected_models=s.initial_checked_models,this.initializeBootstrapComponents(),"function"!=typeof i)console.log("disabling human judgement ensemble model feature",i,typeof i),this.isUemEnabled=!1;else if(this.state.models.includes(n.name)){const e=n.name+"_"+Math.floor(Date.now()/1e3);this.state.models.includes(e)?(console.warn("USER_ENSEMBLE_MODEL.name conflict. disabling human judgement ensemble model feature",n.name,this.state.models),$("#uemInfoModalTitle").html("Disabling human judgement ensemble model feature"),$("#uemInfoModalBody").html(`The default name '${n.name}' was in the models list.`),$("#uemInfoModal").modal("show")):(n.name=e,console.warn("USER_ENSEMBLE_MODEL.name conflict. renamed",n.name,this.state.models,e))}return console.debug("initialize(): initializing UI"),function(e,t,a){function s(e,t){return $(`<div class="form-row">\n    <label for="${e}" class="col-sm-4 col-form-label">${t}:</label>\n    <div class="col-sm-8">\n        <select id="${e}" class="form-control"></select>\n    </div>\n</div>`)}const i=$('<div class="col-md-3" id="forecastViz_options"></div>'),r=$("<form></form>");r.append(s("target_variable","Outcome")),a.forEach((e=>{r.append(s(e,e.replace(/[_-]/g," ").toLowerCase().replace(/\b\w/g,(e=>e.toUpperCase()))))})),r.append(s("intervals","Interval")),i.append(r);const n=$('<div class="form-group form-check forecastViz_select_data ">\n    <input title="curr target" type="checkbox" id="forecastViz_Current_Truth" value="Current Target" checked>\n      &nbsp;<span id="currentTruthDate">Current (current target date here)</span>\n      &nbsp;<span class="forecastViz_dot" style="background-color: lightgrey; "></span>\n    <br>\n    <input title="target as of" type="checkbox" id="forecastViz_Truth_as_of" value="Target as of" checked>\n      &nbsp;<span id="asOfTruthDate">(as of truth date here)</span>\n      &nbsp;<span class="forecastViz_dot" style="background-color: black;"></span>\n</div>');let o;i.append('<div class="pt-md-3">Select Target Data:</div>'),i.append(n),o=t?'<div class="dropdown">\n  <button class="btn btn-sm dropdown-toggle" type="button" id="dropdownMenuButton" style="float: right;" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n    Actions\n  </button>\n  <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">\n    <a class="dropdown-item" id="addUserEnsemble" href="#">Add User Ensemble</a>\n    <a class="dropdown-item disabled" id="removeUserEnsemble" href="#">Remove User Ensemble</a>\n    <a class="dropdown-item disabled" id="downloadUserEnsemble" href="#">Download User Ensemble CSV</a>\n    <a class="dropdown-item disabled" id="infoUserEnsemble" href="#">User Ensemble Info...</a>\n    <a class="dropdown-item" id="editNameUserEnsemble" href="#">Edit User Ensemble Model Name...</a>\n    <a class="dropdown-item" id="helpUserEnsemble" target="_blank" href="https://github.com/reichlab/predtimechart#human-judgement-ensemble-model">Help...</a>\n  </div>\n</div>\n':"",i.append($(o+'<button type="button" class="btn btn-sm rounded-pill" id="forecastViz_shuffle" style="float: right;">\n    Shuffle Colours</button>\n<label class="forecastViz_label" for="forecastViz_all">Select Models:</label>\n<input type="checkbox" id="forecastViz_all">')),i.append($('<div id="forecastViz_select_model"></div>'));const l=$('<div class="col-md-9" id="forecastViz_viz"></div>'),d=$('<div class="container">\n    <div class="col-md-12 text-center">\n        <button type="button" class="btn btn-primary" id="decrement_as_of">&lt;</button>\n        <button type="button" class="btn btn-primary" id="increment_as_of">&gt;</button>\n    </div>\n</div>');l.append($('<p class="forecastViz_disclaimer"><b><span id="disclaimer">(disclaimer here)</span></b></p>')),l.append($('<div id="ploty_div" style="width: 100%; height: 72vh; position: relative;"></div>')),l.append(d),l.append($('<p style="text-align:center"><small>Note: You can navigate to forecasts from previous weeks with the left and right arrow keys</small></p>')),e.empty().append(i,l)}($(o),this.isUemEnabled,Object.keys(this.state.task_ids)),this.initializeUI(s.initial_task_ids),this.addEventHandlers(),console.debug("initialize(): fetching data and updating plot"),this.fetchDataUpdatePlot(!0,!0),l&&this.showOptionsInURL(),console.debug("initialize(): done"),null},getOptionsFromURL(e){const t={},a=new URLSearchParams(window.location.search);a.get("as_of")&&(t.initial_as_of=a.get("as_of")),a.get("interval")&&(t.initial_interval=a.get("interval")),a.get("target_var")&&(t.initial_target_var=a.get("target_var")),a.get("model")&&(t.initial_checked_models=a.getAll("model")),a.get("xaxis_range")&&(t.initial_xaxis_range=a.getAll("xaxis_range")),a.get("yaxis_range")&&(t.initial_yaxis_range=a.getAll("yaxis_range"));const s={};return Object.keys(e).forEach((function(e){a.get(e)&&(s[e]=a.get(e))})),0!==Object.keys(s).length&&(t.initial_task_ids=s),t},showOptionsInURL(){const e=new URL(window.location.origin+window.location.pathname);e.searchParams.append("as_of",this.state.selected_as_of_date),e.searchParams.append("interval",this.state.selected_interval),e.searchParams.append("target_var",this.state.selected_target_var);const t=document.getElementById("ploty_div"),a=t.layout.xaxis.range,s=t.layout.yaxis.range,i=2===a.length&&-1===a[0]&&6===a[1],r=2===s.length&&-1===s[0]&&4===s[1];i||t.layout.xaxis.range.forEach((t=>{const a=t.slice(0,10);e.searchParams.append("xaxis_range",a)})),r||t.layout.yaxis.range.forEach((t=>{e.searchParams.append("yaxis_range",t)})),this.state.selected_models.forEach((t=>{e.searchParams.append("model",t)}));for(const[t,a]of Object.entries(this.selectedTaskIDValues()))e.searchParams.append(t,a);null!==window.history.state&&e.toString()===window.history.state.toString()||window.history.replaceState(e.toString(),"",e)},initializeUI(e){this.initializeTargetVarsUI(),this.initializeTaskIDsUI(e),this.initializeIntervalsUI(),this.updateModelsList(),$("#currentTruthDate").text(`Current (${this.state.current_date})`),this.updateTruthAsOfCheckboxText(),$("#disclaimer").text(this.state.disclaimer);const t=document.getElementById("ploty_div"),a=this.getPlotlyLayout();Plotly.newPlot(t,[],a,{modeBarButtonsToRemove:["lasso2d","autoScale2d"],modeBarButtonsToAdd:[{name:"Jump to As_Of",icon:{width:448,height:512,path:"M128 0c17.7 0 32 14.3 32 32V64H288V32c0-17.7 14.3-32 32-32s32 14.3 32 32V64h48c26.5 0 48 21.5 48 48v48H0V112C0 85.5 21.5 64 48 64H96V32c0-17.7 14.3-32 32-32zM0 192H448V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V192zm64 80v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V272c0-8.8-7.2-16-16-16H80c-8.8 0-16 7.2-16 16zm128 0v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V272c0-8.8-7.2-16-16-16H208c-8.8 0-16 7.2-16 16zm144-16c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V272c0-8.8-7.2-16-16-16H336zM64 400v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V400c0-8.8-7.2-16-16-16H80c-8.8 0-16 7.2-16 16zm144-16c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V400c0-8.8-7.2-16-16-16H208zm112 16v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V400c0-8.8-7.2-16-16-16H336c-8.8 0-16 7.2-16 16z"},click:()=>null}]}),t.on("plotly_relayout",(function(){c.showOptionsInURL()})),this.initializeDateRangePicker()},initializeDateRangePicker(){const t=$("[data-title='Jump to As_Of']"),a=c.state.available_as_ofs[c.state.selected_target_var];t.daterangepicker({singleDatePicker:!0,showDropdowns:!0,minYear:parseInt(a[0].slice(0,4)),maxYear:parseInt(a.at(-1).slice(0,4))}),t.on("apply.daterangepicker",(function(t,a){const s=function(t,a){if(0===a.length)throw new Error("availableYears is empty");if(-1!==a.indexOf(t))return t;const s=e(t),i=a.map((t=>e(t)));let r=null;return i.forEach((e=>{const t=null===r?null:Math.abs(r-s),a=Math.abs(e-s);(null===r||a<t)&&(r=e)})),r.toISOString().split("T")[0]}(a.startDate.format("YYYY-MM-DD"),c.state.available_as_ofs[c.state.selected_target_var]);a.setStartDate(new Date),a.setEndDate(new Date),s!==c.state.selected_as_of_date&&(c.state.selected_as_of_date=s,c.fetchDataUpdatePlot(!0,!1),c.updateTruthAsOfCheckboxText())}))},initializeBootstrapComponents(){const e=$('<div class="modal fade" id="uemInfoModal" tabIndex="-1" aria-labelledby="uemInfoModalTitle"\n     aria-hidden="true">\n    <div class="modal-dialog">\n        <div class="modal-content">\n            <div class="modal-header">\n                <h5 class="modal-title" id="uemInfoModalTitle">(title here)</h5>\n                <a class="close" data-dismiss="modal">&times;</a>\n            </div>\n            <div class="modal-body" id="uemInfoModalBody">(body here)</div>\n            <div class="modal-footer">\n                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>\n            </div>\n        </div>\n    </div>\n</div>');$(document.body).append(e);const t=$('<div class="modal fade" id="uemEditModelNameModal" tabIndex="-1" aria-labelledby="uemInfoModalTitle"\n     aria-hidden="true">\n    <div class="modal-dialog">\n        <div class="modal-content">\n            <div class="modal-header">\n                <h5 class="modal-title" id="uemInfoModalTitle">User Ensemble Model Name</h5>\n                <a class="close" data-dismiss="modal">&times;</a>\n            </div>\n            <div class="modal-body">\n               <form novalidate onsubmit="return false">\n                   <div class="form-group">\n                       <label for="model-name" class="col-form-label">Model name:</label>\n                       <input type="text" class="form-control is-valid" id="uemEditModelName" value="(name here)">\n                       <div class="invalid-feedback hidden">(invalid here)</div>\n                   </div>\n               </form>\n            </div>\n            <div class="modal-footer">\n                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>\n                <button type="button" class="btn btn-primary" data-dismiss="modal" id="uemEditSaveButton">Save</button>\n           </div>\n    </div>\n</div>');$(document.body).append(t)},initializeTargetVarsUI(){const e=$("#target_variable"),t=this.state;this.state.target_variables.forEach((function(a){const s=a.value===t.selected_target_var?"selected":"",i=`<option value="${a.value}" ${s} >${a.text}</option>`;e.append(i)}))},initializeTaskIDsUI(e){const t=this.state;Object.keys(this.state.task_ids).forEach((function(a){const s=$(`#${a}`);t.task_ids[a].forEach((t=>{const i=t.value===e[a]?"selected":"",r=`<option value="${t.value}" ${i} >${t.text}</option>`;s.append(r)}))}))},initializeIntervalsUI(){const e=$("#intervals"),t=this.state;this.state.intervals.forEach((function(a){const s=`<option value="${a}" ${a===t.selected_interval?"selected":""} >${a}</option>`;e.append(s)}))},updateModelsList(){const e=$("#forecastViz_select_model"),t=this.state;e.empty(),this.state.models.filter((function(e){return c.state.forecasts.hasOwnProperty(e)})).forEach((function(a){const s=t.selected_models.indexOf(a)>-1,i=t.models.indexOf(a);e.append(o(a,t.colors[i],!0,s))})),this.state.models.filter((function(e){return!c.state.forecasts.hasOwnProperty(e)})).forEach((function(a){const s=t.selected_models.indexOf(a)>-1;e.append(o(a,"grey",!1,s))})),this.addModelCheckEventHandler(),function(){const e=n.lastError,t=$(`#${n.name}`).parent();if(null===e)t.children("img").remove();else{const a=$(`<img src="https://github.githubassets.com/images/icons/emoji/unicode/26a0.png" title="${e}" alt="${e}"\n    class="align-baseline" style="height: 16px; width: 16px; display: inline-block;" >`);t.after("&nbsp;",a)}}()},addEventHandlers(){$("#target_variable").on("change",(function(){c.state.selected_target_var=this.value,c.fetchDataUpdatePlot(!0,!0),c.showOptionsInURL()})),Object.keys(this.state.task_ids).forEach((function(e){$(`#${e}`).on("change",(function(){c.fetchDataUpdatePlot(!0,!0)}))})),$("#intervals").on("change",(function(){c.state.selected_interval=this.value,c.fetchDataUpdatePlot(!1,!1),c.showOptionsInURL()})),$("#forecastViz_Current_Truth").change((function(){l()})),$("#forecastViz_Truth_as_of").change((function(){l()})),$("#forecastViz_shuffle").click((function(){c.state.colors=c.state.colors.sort((()=>.5-Math.random())),c.updateModelsList(),c.updatePlot(!0)})),$("#addUserEnsemble").click((function(e){e.preventDefault(),c.removeUserEnsembleModel(),c.addUserEnsembleModel(),c.updateModelsList(),c.updatePlot(!0),$("#removeUserEnsemble").removeClass("disabled"),$("#downloadUserEnsemble").removeClass("disabled"),$("#infoUserEnsemble").removeClass("disabled"),$("#editNameUserEnsemble").addClass("disabled")})),$("#removeUserEnsemble").click((function(e){e.preventDefault(),c.removeUserEnsembleModel(),c.updateModelsList(),c.updatePlot(!0),$("#removeUserEnsemble").addClass("disabled"),$("#downloadUserEnsemble").addClass("disabled"),$("#infoUserEnsemble").addClass("disabled"),$("#editNameUserEnsemble").removeClass("disabled")})),$("#downloadUserEnsemble").click((function(e){e.preventDefault();let t="";c._calcUemForecasts(n.models,c.state.selected_target_var,c.state.selected_as_of_date,n.name).then((e=>{if(!e.ok)return console.error("#downloadUserEnsemble click: bad response",e),e.text().then((e=>{throw new Error(e)}));const a=Object.fromEntries(e.headers)["content-disposition"];return t=a.split('"')[1],e.text()})).then((e=>{!function(e,t,a){if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(blob,a);else{const t=document.createElement("a");document.body.appendChild(t);const s=new Blob([e],{type:"text/csv"}),i=URL.createObjectURL(s);t.setAttribute("href",i),t.setAttribute("download",a),t.click(),setTimeout((()=>{window.URL.revokeObjectURL(i),document.body.removeChild(t)}),0)}}(e,0,t),$("#uemInfoModalTitle").html("CSV File Downloaded"),$("#uemInfoModalBody").html(`User ensemble downloaded to "${t}".`),$("#uemInfoModal").modal("show")})).catch((e=>{console.error(`#downloadUserEnsemble click: error: ${e.message}`),$("#uemInfoModalTitle").html("Error Downloading CVS File"),$("#uemInfoModalBody").html(`"${e.message}"`),$("#uemInfoModal").modal("show")}))})),$("#infoUserEnsemble").click((function(e){e.preventDefault();const t=n.name,a=n.models.join(", "),s=null===n.lastError?"(no errors)":n.lastError,i=$(`<form>\n  <div class="form-group">\n    <label for="model-name" class="col-form-label">Model name:</label>\n    <input type="text" class="form-control" id="model-name" readonly value="${t}">\n  </div>\n  <div class="form-group">\n    <label for="model-list" class="col-form-label">Component models:</label>\n    <input type="text" class="form-control" id="model-list" readonly value="${a}">\n  </div>\n  <div class="form-group">\n    <label for="last-error" class="col-form-label">Last error:</label>\n    <textarea class="form-control" id="last-error" readonly>${s}</textarea>\n  </div>\n</form>`);$("#uemInfoModalTitle").html("User Ensemble Settings"),$("#uemInfoModalBody").html(i),$("#uemInfoModal").modal("show")})),$("#uemEditModelName").on("input",(function(){const e=0===(s=$("#uemEditModelName").val()).length?"name is required":s.length>31?"name is more than 31 characters":c.state.models.includes(s)?"name already used":!/^[a-zA-Z0-9_-]+$/.test(s)&&"name had invalid characters. must be letters, numbers, underscores, or hypens'",t=$("#uemEditModelNameModal .invalid-feedback"),a=$("#uemEditModelNameModal input");var s;e?(t.html(e),t.show(),a.addClass("is-invalid")):(t.html(""),t.hide(),a.removeClass("is-invalid"))})),$("#uemEditSaveButton").click((function(){const e=$("#uemEditModelName").val();n.name=e,console.info(`saved new user ensemble model name: '${e}'`)})),$("#editNameUserEnsemble").click((function(e){e.preventDefault();const t=n.name;$("#uemEditModelName").val(t),$("#uemEditModelNameModal").modal("show")})),$("#forecastViz_all").change((function(){$(this).prop("checked")?(c.state.last_selected_models=c.state.selected_models,c.state.selected_models=c.selectableModels()):c.state.selected_models=c.state.last_selected_models,c.checkModels(c.state.selected_models),c.updatePlot(!0),c.showOptionsInURL()})),this.addModelCheckEventHandler(),$("#decrement_as_of").click((function(){c.decrementAsOf()})),$("#increment_as_of").click((function(){c.incrementAsOf()})),window.addEventListener("keydown",(function(e){"ArrowLeft"===e.code?c.decrementAsOf():"ArrowRight"===e.code&&c.incrementAsOf()}))},addModelCheckEventHandler(){$(".model-check").change((function(){const e=$(this),t=e.prop("id"),a=e.prop("checked"),s=c.state.selected_models.indexOf(t)>-1;a&&!s?c.state.selected_models.push(t):!a&&s&&(c.state.selected_models=c.state.selected_models.filter((function(e){return e!==t}))),c.fetchDataUpdatePlot(!1,!1),c.showOptionsInURL()}))},incrementAsOf(){const e=this.state,t=e.available_as_ofs[e.selected_target_var].indexOf(e.selected_as_of_date);t<e.available_as_ofs[e.selected_target_var].length-1&&(e.selected_as_of_date=e.available_as_ofs[e.selected_target_var][t+1],this.fetchDataUpdatePlot(!0,!1),this.updateTruthAsOfCheckboxText(),this.showOptionsInURL())},decrementAsOf(){const e=this.state,t=e.available_as_ofs[e.selected_target_var].indexOf(e.selected_as_of_date);t>0&&(e.selected_as_of_date=e.available_as_ofs[e.selected_target_var][t-1],this.fetchDataUpdatePlot(!0,!1),this.updateTruthAsOfCheckboxText(),this.showOptionsInURL())},updateTruthAsOfCheckboxText(){$("#asOfTruthDate").text(`As of ${this.state.selected_as_of_date}`)},selectableModels(){return this.state.models.filter((function(e){return c.state.forecasts.hasOwnProperty(e)}))},checkModels(e){this.state.models.forEach((function(t){const a=e.indexOf(t)>-1;$(`#${t}`).prop("checked",a)}))},selectedTaskIDs(){const e={};return Object.keys(this.state.task_ids).forEach((t=>{const a=$(`#${t}`).val(),s=c.state.task_ids[t].find((e=>e.value===a));e[t]=s})),e},selectedTaskIDValues(){const e={};for(const[t,a]of Object.entries(this.selectedTaskIDs()))e[t]=a.value;return e},fetchDataUpdatePlot(e,t){const a=t;if(e){const i=[this.fetchAsOfTruth(),this.fetchForecasts()];t&&i.push(this.fetchCurrentTruth()),console.debug(`fetchDataUpdatePlot(${e}, ${t}): waiting on promises`);const r=$("#ploty_div");this.isIndicateRedraw&&r.fadeTo(0,.25),Promise.all(i).then((i=>{if(console.debug(`fetchDataUpdatePlot(${e}, ${t}): Promise.all() done. updating plot`,i),this.isUemEnabled&&this.state.models.includes(n.name))try{this.state.forecasts[n.name]=s(n.models,this.state.forecasts),n.lastError=null,console.debug("fetchDataUpdatePlot(): forecasts:",this.state.forecasts[n.name])}catch(e){n.lastError=e,console.error(`fetchDataUpdatePlot(): error calling _calcUemForecasts(): ${e}`)}this.updateModelsList(),this.updatePlot(a),this.isIndicateRedraw&&r.fadeTo(0,1)}))}else console.debug(`fetchDataUpdatePlot(${e}, ${t}): updating plot`),this.updatePlot(a)},fetchCurrentTruth(){return this.state.current_truth=[],this._fetchData(!1,this.state.selected_target_var,this.selectedTaskIDValues(),this.state.current_date).then((e=>e.json())).then((e=>{this.state.current_truth=e})).catch((e=>console.error(`fetchCurrentTruth(): error: ${e.message}`)))},fetchAsOfTruth(){return this.state.as_of_truth=[],this._fetchData(!1,this.state.selected_target_var,this.selectedTaskIDValues(),this.state.selected_as_of_date).then((e=>e.json())).then((e=>{this.state.as_of_truth=e})).catch((e=>console.error(`fetchAsOfTruth(): error: ${e.message}`)))},fetchForecasts(){return this.state.forecasts={},this._fetchData(!0,this.state.selected_target_var,this.selectedTaskIDValues(),this.state.selected_as_of_date).then((e=>e.json())).then((e=>{this.state.forecasts=e})).catch((e=>console.error(`fetchForecasts(): error: ${e.message}`)))},addUserEnsembleModel(){const e=this.state.selected_models.filter((function(e){return e!==n.name}));if(e.length<=1)return console.warn(`addUserEnsembleModel(): must select two or more componentModels. #selected=${e.length}`),$("#uemInfoModalTitle").html("Invalid Component Models"),$("#uemInfoModalBody").html(`Must select two or more componentModels (${e.length} selected).`),void $("#uemInfoModal").modal("show");try{this.state.forecasts[n.name]=s(e,this.state.forecasts),n.lastError=null,console.debug("addUserEnsembleModel(): forecasts:",this.state.forecasts[n.name])}catch(e){n.lastError=e,console.error(`addUserEnsembleModel(): error calling _calcUemForecasts(): ${e}`)}this.state.models.includes(n.name)||this.state.models.unshift(n.name),this.state.selected_models.includes(n.name)||this.state.selected_models.push(n.name),n.models.length=0,n.models.push(...e),console.debug("addUserEnsembleModel(): created:",n.name,n.models)},removeUserEnsembleModel(){delete this.state.forecasts[n.name],this.state.models=this.state.models.filter((e=>e!==n.name)),this.state.selected_models=this.state.selected_models.filter((e=>e!==n.name)),n.models.length=0,n.lastError=null},updatePlot(e){const t=document.getElementById("ploty_div"),a=this.getPlotlyData();let s=this.getPlotlyLayout();0===a.length&&(s={title:{text:"No Visualization Data Found"}});const i=t.layout.xaxis.range,r=t.layout.yaxis.range,n=2===i.length&&-1===i[0]&&6===i[1],o=2===r.length&&-1===r[0]&&4===r[1];Plotly.react(t,a,s),n?null!=this.state.initial_xaxis_range&&Plotly.relayout(t,"xaxis.range",this.state.initial_xaxis_range):Plotly.relayout(t,"xaxis.range",i),e||(o?null!=this.state.initial_yaxis_range&&Plotly.relayout(t,"yaxis.range",this.state.initial_yaxis_range):Plotly.relayout(t,"yaxis.range",r)),this.initializeDateRangePicker()},getPlotlyLayout(){if(0===this.state.target_variables.length)return{};const e=this.state.target_variables.filter((e=>e.value===this.state.selected_target_var))[0].plot_text;return{autosize:!0,showlegend:!1,title:{text:`Forecasts of ${e} <br> in ${Object.values(this.selectedTaskIDs()).map((e=>e.text)).join(", ")} as of ${this.state.selected_as_of_date}`,x:.5,y:.9,xanchor:"center",yanchor:"top"},xaxis:{title:{text:"Date"},rangeslider:{}},yaxis:{title:{text:e,hoverformat:".2f"},fixedrange:!1}}},getPlotlyData(){const e=this.state;let t=[];e.selected_truth.includes("Current Target")&&0!==Object.keys(e.current_truth).length&&t.push({x:e.current_truth.date,y:e.current_truth.y,type:"scatter",mode:"lines",name:"Current Target",marker:{color:"darkgray"}}),e.selected_truth.includes("Target as of")&&0!==Object.keys(e.as_of_truth).length&&t.push({x:e.as_of_truth.date,y:e.as_of_truth.y,type:"scatter",mode:"lines",opacity:.5,name:`Target as of ${e.selected_as_of_date}`,marker:{color:"black"}});let a=[];0!==e.forecasts.length&&(a=Object.keys(e.forecasts).map((t=>{if(e.selected_models.includes(t)){const a=e.models.indexOf(t),s=e.forecasts[t],i=s.target_end_date,r=s["q0.025"],n=s["q0.25"],o=s["q0.5"],l=s["q0.75"],d=s["q0.975"],c=[];for(let e=0;e<i.length;e++)c.push({date:i[e],lq1:r[e],lq2:n[e],uq1:l[e],uq2:d[e],mid:o[e]});c.sort(((e,t)=>moment(e.date).isBefore(t.date)?-1:1));for(let e=0;e<c.length;e++)s.target_end_date[e]=c[e].date,s["q0.025"][e]=c[e].lq1,s["q0.25"][e]=c[e].lq2,s["q0.5"][e]=c[e].mid,s["q0.75"][e]=c[e].uq1,s["q0.975"][e]=c[e].uq2;const m=[];m.push(s.target_end_date.slice(0)[0]);const p=[];return p.push(s["q0.5"].slice(0)[0]),{x:m,y:p,mode:"lines",type:"scatter",name:t,hovermode:!1,opacity:.7,line:{color:e.colors[a]},hoverinfo:"none"}}return[]}))),t=a.concat(...t);let s=[];return 0!==e.forecasts.length&&(s=Object.keys(e.forecasts).map((t=>{if(e.selected_models.includes(t)){const a=e.models.indexOf(t),s="hosp"===e.selected_target_var?"lines":"lines+markers",i=e.forecasts[t];let r,n;const o={x:i.target_end_date,y:i["q0.5"],type:"scatter",name:t,opacity:.7,mode:s,line:{color:e.colors[a]}};if("50%"===e.selected_interval)n="q0.25",r="q0.75";else{if("95%"!==e.selected_interval)return[o];n="q0.025",r="q0.975"}const l=(Object.keys(e.as_of_truth).length,i.target_end_date),d=(Object.keys(e.as_of_truth).length,i[n]),c=(Object.keys(e.as_of_truth).length,i[r]);return[o,{x:[].concat(l,l.slice().reverse()),y:[].concat(d,c.slice().reverse()),fill:"toself",fillcolor:e.colors[a],opacity:.3,line:{color:"transparent"},type:"scatter",name:t,showlegend:!1,hoverinfo:"skip"}]}return[]}))),t=t.concat(...s),t}},m=c})();var y=g.Z;export{y as default};